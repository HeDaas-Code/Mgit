# 写作Copilot - 配置和使用指南

## 如何配置插件

### 方法1: 通过插件管理器配置

1. **打开插件管理器**
   - 在MGit主菜单中选择 "工具" → "插件管理"
   - 或使用快捷键访问

2. **找到写作Copilot插件**
   - 在插件列表中找到 "写作Copilot" 插件
   - 插件类型显示为 "编辑器"

3. **点击"设置"按钮**
   - 在插件卡片右侧有一个 "设置" 按钮
   - 点击打开设置对话框

4. **配置各项设置**
   
   **API设置:**
   - API基础URL: `https://api.siliconflow.cn/v1` (默认)
   - API密钥: 输入您的SiliconFlow API密钥
   - 模型: 选择要使用的AI模型
     - DeepSeek V2.5 (推荐)
     - Qwen2.5 7B
     - GLM-4 9B
     - Llama 3.1 8B

   **功能设置:**
   - 启用行内补全: 开启/关闭自动补全功能
   - 补全触发方式:
     - 自动触发: 停止输入后自动触发
     - 手动触发: 仅通过菜单或快捷键触发
     - 两者都启用: 同时支持自动和手动
   - 自动补全延迟: 设置触发延迟时间 (500-5000毫秒)

   **代理设置:**
   - 启用任务审查: 是否在代理执行任务后需要确认

   **高级设置:**
   - 最大上下文长度: 发送给AI的最大上下文字符数 (1000-8000)

5. **测试连接**
   - 配置API密钥后，点击 "测试API连接" 按钮
   - 验证配置是否正确

6. **保存设置**
   - 点击 "确定" 按钮保存所有设置
   - 设置会立即生效

### 方法2: 通过配置文件配置

插件设置保存在MGit的配置文件中，也可以手动编辑：

```json
{
  "plugins": {
    "writing_copilot": {
      "api_base_url": "https://api.siliconflow.cn/v1",
      "api_key": "YOUR_API_KEY_HERE",
      "model_name": "deepseek-ai/DeepSeek-V2.5",
      "enable_inline_completion": true,
      "completion_trigger": "auto",
      "auto_completion_delay": 1000,
      "enable_task_review": true,
      "max_context_length": 4000
    }
  }
}
```

## 如何使用Copilot

### 访问Copilot面板

#### 方法1: 右键菜单（推荐）

1. 在编辑器中任意位置右键点击
2. 在上下文菜单中选择 "打开写作Copilot"
3. Copilot面板会出现并获得焦点

#### 方法2: 侧边栏

1. 在MGit侧边栏查找 "写作Copilot" 标签
2. 点击标签打开Copilot面板

#### 方法3: 视图菜单

1. 点击主菜单 "视图"
2. 选择 "写作Copilot" (如果可用)

### 快速补全

#### 方法1: 右键菜单

1. 将光标放在需要补全的位置
2. 右键点击
3. 选择 "补全当前行"
4. 补全建议会显示在Copilot面板

#### 方法2: 自动触发

1. 确保在设置中启用了 "自动触发" 或 "两者都启用"
2. 正常输入文字
3. 停止输入1秒（可配置）后自动触发
4. 补全建议出现在侧边栏
5. 点击 "接受" 或 "拒绝"

### 使用各种模式

**补全模式:**
- 用于继续当前句子或段落
- 自动或手动触发
- 在补全标签页中查看和接受建议

**编辑模式:**
1. 在编辑器中选择要编辑的文本
2. 切换到 "编辑" 标签页
3. 点击相应的操作:
   - 改进写作
   - 修正语法
   - 扩展内容
   - 简化内容
   - 重写

**创作模式:**
1. 切换到 "创作" 标签页
2. 输入创作提示
3. 点击 "生成内容"
4. 查看结果后点击 "插入到文档"

**对话模式:**
1. 切换到 "对话" 标签页
2. 输入问题或请求
3. 按回车或点击 "发送"
4. 查看AI的回复
5. 继续对话或清除历史

**代理模式:**
1. 切换到 "代理" 标签页
2. 描述要完成的任务
3. 点击 "执行任务"
4. 在日志中查看执行过程
5. 如果启用了审查，切换到 "任务审查" 标签页确认

**任务审查:**
1. 切换到 "任务审查" 标签页
2. 选择待审查的任务
3. 查看任务详情
4. 点击 "批准" 确认或 "拒绝" 放弃

## 常见问题

### Q: 为什么看不到设置按钮？

A: 确保：
1. 插件已正确加载
2. 您使用的是最新版本的MGit
3. 尝试重新加载插件（在插件管理器中点击"刷新"）

### Q: 设置保存后不生效？

A: 尝试：
1. 禁用插件然后重新启用
2. 重启MGit应用
3. 检查配置文件是否正确保存

### Q: 右键菜单中看不到Copilot选项？

A: 确认：
1. 插件已启用
2. 当前编辑器窗口已激活
3. 右键点击位置是在编辑器区域内

### Q: API连接测试失败？

A: 检查：
1. API密钥是否正确
2. 网络连接是否正常
3. API基础URL是否正确
4. API余额是否充足

## 快捷键（如果系统支持）

- 手动触发补全: `Ctrl+Space` (可能需要在系统中配置)
- 打开Copilot面板: 右键菜单
- 接受补全: 在补全面板点击"接受"

## 提示和技巧

1. **首次使用**: 先在设置中配置API密钥并测试连接
2. **性能优化**: 如果响应较慢，可以：
   - 减少最大上下文长度
   - 选择更快的模型 (如 Qwen2.5 7B)
   - 切换到手动触发模式
3. **成本控制**: 
   - 使用手动触发而非自动触发
   - 增加自动补全延迟时间
   - 合理使用代理模式
4. **最佳实践**:
   - 编写清晰的提示词
   - 在代理模式中分步描述任务
   - 启用任务审查以防止意外更改

## 获取帮助

如果遇到问题：
1. 查看MGit日志: 菜单 → 帮助 → 查看日志
2. 查看完整文档: `plugins/writing_copilot/README.md`
3. 查看使用示例: `plugins/writing_copilot/EXAMPLES.md`
4. 在GitHub提交Issue

---

**祝您写作愉快！** 🚀
