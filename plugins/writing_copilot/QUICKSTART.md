# 写作Copilot插件 - 快速开始指南

## 安装步骤

### 1. 安装依赖

确保MGit的Python环境已激活，然后安装AI相关依赖：

```bash
# 如果使用虚拟环境
source venv-dev/bin/activate  # Linux/Mac
# 或
venv-dev\Scripts\activate  # Windows

# 安装依赖
pip install langchain langchain-community langchain-openai openai
```

### 2. 获取API密钥

1. 访问 [SiliconFlow](https://siliconflow.cn/)
2. 注册账号
3. 在控制台获取API密钥

### 3. 配置插件

1. 启动MGit应用
2. 打开"插件管理"
3. 找到"写作Copilot"插件并启用
4. 点击插件设置按钮
5. 填入配置信息：
   - **API基础URL**: `https://api.siliconflow.cn/v1`
   - **API密钥**: 你的SiliconFlow API密钥
   - **模型名称**: 选择一个模型（推荐DeepSeek V2.5）

## 首次使用

### 测试行内补全

1. 创建或打开一个Markdown文档
2. 输入一些文字，如："Python是一门"
3. 停止输入，等待1秒
4. 插件会在侧边栏显示建议的补全
5. 点击"接受"将补全插入到文档中

### 测试编辑功能

1. 选择文档中的一段文字
2. 切换到"编辑"标签页
3. 点击"改进写作"按钮
4. AI会自动优化选定的文字

### 测试对话功能

1. 切换到"对话"标签页
2. 输入问题，如："如何改进这段文字的表达？"
3. 查看AI的回复

### 测试代理功能

1. 切换到"代理"标签页
2. 输入任务，如：
   ```
   在当前文档末尾添加一个"总结"章节，包含对文档主要内容的简短总结。
   ```
3. 点击"执行任务"
4. 查看执行日志
5. 如果启用了审查，切换到"任务审查"标签页批准任务

## 示例任务

### 行内补全示例

**输入**:
```
# Python编程入门

Python是一门
```

**可能的补全**:
```
易于学习的高级编程语言，广泛应用于数据科学、Web开发、自动化等领域。
```

### 编辑模式示例

**原文**:
```
Python很好用因为它简单而且功能强大
```

**改进后** (使用"改进写作"):
```
Python以其简洁的语法和强大的功能而广受欢迎，使其成为初学者和专业开发者的理想选择。
```

### 创作模式示例

**提示**:
```
写一段关于MGit应用的介绍，包括它的主要功能和优势。
```

**生成结果**:
```
MGit是一款集成了Markdown编辑和Git版本控制的强大应用。它提供了直观的用户界面，让用户可以轻松管理文档的版本历史。主要功能包括实时Markdown预览、Git操作集成、插件系统支持等。MGit特别适合需要频繁编写和修改文档的用户，如技术写作者、开发者和研究人员。
```

### 代理模式示例

**任务**:
```
1. 创建一个名为 docs/tutorial 的新分支
2. 在当前文档中添加一个"教程"章节
3. 提交更改，提交信息为"添加教程章节"
```

**执行结果**:
代理会依次执行以下操作：
1. 调用`create_branch`工具创建新分支
2. 调用`append_to_document`工具添加内容
3. 调用`commit_changes`工具提交更改

## 常见使用场景

### 场景1: 快速起草文档

1. 使用"创作"模式生成文档框架
2. 使用"行内补全"快速填充内容
3. 使用"编辑"模式优化文字

### 场景2: 改进现有文档

1. 打开文档
2. 使用"对话"模式询问改进建议
3. 选择段落使用"编辑"模式逐一改进
4. 使用"代理"模式批量处理格式

### 场景3: 文档版本管理

1. 使用"代理"模式创建特性分支
2. 在分支上进行编辑
3. 通过"任务审查"检查更改
4. 批准并合并到主分支

## 配置优化

### 性能优化

如果响应较慢，可以调整以下设置：

1. **减少上下文长度**: 在高级设置中降低"最大上下文长度"
2. **选择更快的模型**: 尝试使用Qwen2.5 7B或Llama 3.1 8B
3. **手动触发**: 将补全触发方式改为"手动触发"

### 成本优化

如果关注API调用成本：

1. **禁用自动补全**: 仅使用手动触发
2. **减少对话**: 尽量使用编辑和创作模式
3. **批量操作**: 合并多个小任务为一个代理任务

## 故障排查

### 问题: 插件无法加载

**解决方案**:
```bash
# 检查依赖安装
pip list | grep langchain

# 重新安装
pip install --upgrade langchain langchain-community langchain-openai openai
```

### 问题: API调用失败

**检查清单**:
- [ ] API密钥是否正确
- [ ] 网络连接是否正常
- [ ] API余额是否充足
- [ ] 基础URL是否正确

### 问题: 补全不触发

**解决方案**:
1. 检查"启用行内补全"是否开启
2. 确认延迟时间设置（默认1000ms）
3. 尝试手动触发测试

## 进阶使用

### 自定义提示词

在创作和对话模式中，使用更具体的提示词可以获得更好的结果：

**通用提示词**:
```
写一篇关于AI的文章
```

**优化提示词**:
```
写一篇1000字的科普文章，介绍人工智能的基本概念、发展历史和实际应用。使用通俗易懂的语言，包含实例说明。文章应包含引言、主体（3-4个小节）和结论。
```

### 代理任务链

可以创建复杂的任务链：

```
任务: 文档重组和版本管理

步骤:
1. 读取所有.md文件的标题和内容摘要
2. 创建一个名为 reorganize-docs 的新分支
3. 创建一个目录文件 README.md，列出所有文档及其摘要
4. 在每个文档开头添加目录链接
5. 提交所有更改
6. 切换回主分支
```

## 获取帮助

- 查看完整文档: `plugins/writing_copilot/README.md`
- 查看日志: MGit菜单 → 帮助 → 查看日志
- 报告问题: 在GitHub仓库提交Issue

## 下一步

1. 探索更多编辑操作
2. 尝试复杂的代理任务
3. 自定义插件设置以适应你的工作流
4. 分享你的使用经验和技巧

祝写作愉快！🚀
